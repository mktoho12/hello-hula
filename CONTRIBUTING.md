# コントリビューティングガイド

このリポジトリへの貢献に興味を持っていただきありがとうございます！
このドキュメントでは、HuLa IMサービスのローカルDocker環境に貢献する際のガイドラインを説明します。

## 目次

1. [行動規範](#行動規範)
2. [貢献の種類](#貢献の種類)
3. [開発環境のセットアップ](#開発環境のセットアップ)
4. [変更を行う](#変更を行う)
5. [Pull Requestの作成](#pull-requestの作成)
6. [コーディング規約](#コーディング規約)
7. [コミットメッセージの規約](#コミットメッセージの規約)
8. [質問・サポート](#質問・サポート)

## 行動規範

このプロジェクトに参加するすべての人は、お互いを尊重し、建設的な議論を心がけてください。

## 貢献の種類

以下のような貢献を歓迎します：

- **バグ報告**: 問題を発見した場合は、Issueを作成してください
- **機能提案**: 新しいサービスの追加や設定の改善案を提案してください
- **ドキュメントの改善**: README.mdやこのCONTRIBUTING.mdの改善
- **設定の最適化**: Docker ComposeやNacosの設定の改善
- **新しいサービスの追加**: 開発に必要な新しいミドルウェアの追加

## 開発環境のセットアップ

### 前提条件

以下のツールがインストールされていることを確認してください：

- **Docker Desktop** (最新版推奨)
- **Docker Compose** (Docker Desktopに含まれています)
- **Git**
- テキストエディタ（VS Code、IntelliJ IDEAなど）

### リポジトリのクローン

```bash
git clone https://github.com/mktoho12/hello-hula.git
cd hello-hula
```

### 環境変数の設定

`.env.example`を参考に、必要に応じて環境変数を設定します：

```bash
cp .env.example .env
# .envファイルを編集（必要に応じて）
```

### サービスの起動

```bash
docker-compose up -d
```

### 動作確認

以下のサービスにアクセスして、正常に起動していることを確認してください：

- Nacos: http://localhost:8848/nacos (ユーザー名: nacos / パスワード: nacos)
- RocketMQ Console: http://localhost:8080

## 変更を行う

### ブランチ戦略

1. **新しいブランチを作成**

```bash
git checkout -b feature/your-feature-name
# または
git checkout -b fix/your-bug-fix-name
```

ブランチ名のプレフィックス：
- `feature/`: 新機能の追加
- `fix/`: バグ修正
- `docs/`: ドキュメントのみの変更
- `refactor/`: リファクタリング
- `chore/`: ビルドプロセスやツールの変更

2. **変更を加える**

変更を行う際は、以下の点に注意してください：

- 小さく、論理的にまとまった変更にする
- 1つのブランチで複数の無関係な変更を行わない
- 既存の設定ファイルの形式に従う

3. **変更をテスト**

変更後は必ず動作確認を行ってください：

```bash
# サービスを再起動
docker-compose down
docker-compose up -d

# ログを確認
docker-compose logs -f

# 各サービスの状態を確認
docker-compose ps
```

4. **変更をコミット**

```bash
git add .
git commit -m "コミットメッセージ"
```

## Pull Requestの作成

### Pull Requestを送る前に

- [ ] すべての変更をローカルでテストした
- [ ] ドキュメントを更新した（該当する場合）
- [ ] コミットメッセージが規約に従っている
- [ ] 不要なファイル（ログ、一時ファイルなど）をコミットしていない

### Pull Requestの手順

1. **フォークとプッシュ**

```bash
git push origin feature/your-feature-name
```

2. **Pull Requestを作成**

GitHubのWebインターフェースで、Pull Requestを作成してください。

3. **Pull Requestの説明**

以下の情報を含めてください：

- **変更の概要**: 何を変更したか
- **変更の理由**: なぜこの変更が必要か
- **テスト方法**: どのようにテストしたか
- **関連Issue**: 関連するIssue番号（例: Fixes #123）

### Pull Requestテンプレート例

```markdown
## 変更の概要
この変更では...

## 変更の理由
...のため、...を追加/修正しました。

## テスト方法
1. docker-compose up -d を実行
2. ...を確認

## チェックリスト
- [ ] ローカルでテスト済み
- [ ] ドキュメント更新済み
- [ ] 関連するIssueをリンク
```

## コーディング規約

### Docker Composeファイル

- **インデント**: 2スペースを使用
- **サービス名**: 小文字とハイフンを使用（例: `hula-mysql`）
- **コンテナ名**: わかりやすい名前を付ける（例: `hula-mysql`）
- **ポート設定**: `"ホストポート:コンテナポート"` の形式
- **環境変数**: 可能な限り`.env`ファイルで管理
- **ボリューム**: 永続化が必要なデータには名前付きボリュームを使用

### YAMLファイル

- UTF-8エンコーディングを使用
- 行末の空白を削除
- ファイル末尾に改行を入れる

### シェルスクリプト

- シバン（shebang）を含める: `#!/bin/bash`
- エラーハンドリングを適切に行う
- コメントで処理内容を説明

### ドキュメント

- 日本語で記述（このプロジェクトは日本語が主言語）
- Markdownの標準的な記法に従う
- コマンド例には適切なコードブロックを使用

## コミットメッセージの規約

わかりやすく、一貫性のあるコミットメッセージを書いてください。

### 形式

```
<タイプ>: <簡潔な説明>

<詳細な説明（オプション）>
```

### タイプ

- `feat`: 新機能の追加
- `fix`: バグ修正
- `docs`: ドキュメントのみの変更
- `style`: コードの動作に影響しない変更（フォーマット、空白など）
- `refactor`: リファクタリング
- `test`: テストの追加や修正
- `chore`: ビルドプロセスやツールの変更

### 例

```
feat: PostgreSQLサービスを追加

HuLa-Serverでの使用を想定してPostgreSQLコンテナを追加。
初期化スクリプトとボリューム設定を含む。

Fixes #42
```

```
fix: Nacosの起動順序を修正

MySQLのヘルスチェックが完了してからNacosが起動するように
depends_onの設定を修正。
```

```
docs: READMEにトラブルシューティングセクションを追加
```

## 質問・サポート

質問や不明点がある場合は、以下の方法でお問い合わせください：

- **Issue作成**: 技術的な質問や提案は、GitHubのIssueで質問してください
- **ディスカッション**: 一般的な質問や議論は、GitHub Discussionsを利用してください

---

改めて、このプロジェクトへの貢献に感謝いたします！
皆様の貢献により、HuLa IMサービスの開発環境がより良いものになります。
